<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2629 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2629.xml">
<!ENTITY RFC3552 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3552.xml">
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
]>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<rfc category="info" docName="draft-wallstrom-dnsop-dns-test-requirements-00.txt" ipr="trust200902">
 	<front>
    <title abbrev="EPP Security">DNS Test Requirements</title>
   	<author fullname="Patrik Wallstrom" initials="P.W." role="editor"
   		surname="Wallstrom">
    	<organization>IIS</organization>
    	<address>
     		<postal>
     			<street></street>
     			<city>Stockholm</city>
     			<region></region>
     			<code></code>
     			<country>SE</country>
      		</postal>
     		<phone>+46 733 173 956</phone>
     		<email>pawal@iis.se</email>
    	</address>
    </author>

    <date month="September" year="2015" />

    <abstract>
    	<t>This document outlines a set of requirements on a well-behaved
    		DNS delegation of a domain name. A large number of tools has
            been developed to test DNS delegations, but all tools uses a
            different set of requirements for what is a correct setup for
            a delegated domain name. However, there are few requirements
            on how to set up DNS in order to just make the delegation work.
            In order to have a well-behaved delegation that is robust
            to failures and also make DNS resolvers behave consistently,
            there are a large number of things to consider.</t>
    	<t>Based on this document, it should be possible to set up a fully
            functional DNS delegation for a domain, but also to create a
            set of test specifications for how to test a DNS delegation.
            It is typically for testing the Basic section (TODO: add
            in-document reference) is there.
        </t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
    	<t>text text exempelref (<xref target="RFC5730"/>)</t>
    	<t>The requirements are split into these different areas, to easier
    	differentiate between what they are for:</t>

    	<t><list style="numbers">
    		<t>Basic</t>
    		<t>Address</t>
    		<t>Connectivity</t>
    		<t>Consistency</t>
    		<t>Delegation</t>
    		<t>DNSSEC</t>
    		<t>Name server</t>
    		<t>Syntax</t>
    		<t>Zone</t>
    	</list></t>

        <section title="DNS Terminology">
            <t>This document tries to fully follow the DNS terminology as
                defined in <xref target="I-D.ietf-dnsop-dns-terminology"/>. 
            </t>
        </section>

    	<section title="Reserved Words">
    		<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
    		"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
    		and "OPTIONAL" in this document are to be interpreted as
    		described in <xref target="RFC2119"/>.</t>
    	</section>

     </section>

    <section title="Basic requirements">
    	<t>The Basic requirements are fundamental to a working DNS
    		delegation. Without these properties, the rest of the
    		requirements are irrelevant.</t>

    	<section title="The domain name MUST be valid">
    		<t>The domain name MUST follow the rules defined in section 2.3.1
    		of <xref target="RFC1123"/> in order to be able to map the domain
    		into a DNS packet. A domain name is normally valid if the
            name has been registered with a domain name registry.</t>
    	</section>

    	<section title="The domain MUST have a parent domain">
    		<t>A DNS delegation MUST have a parent domain from which it is
    		delegated. The concept of zone cuts was first described in
    		<xref target="RFC1034"/> and later clarified in section 6 of
    		<xref target="RFC2182"/>. The only exception is the root zone,
    		which do not have a parent zone.</t>
    	</section>

    	<section title="The domain MUST have at least one working name server">
            <t>A fully working DNS delegation have a parent zone delegating
            the zone to a set of child name servers. At least one name
            server MUST be able to answer DNS queries in order to be able
            to serve authoritative data for the child zone.</t>
    	</section>
    </section>

    <section title="Address requirements">
    	<t>A delegation in the public internet DNS hierarchy will use the
            globally unique address space.
        </t>
    	<section title="Name server address MUST be globally routable">
            <t>In order for the domain and its resources to be accessible,
            authoritative name servers must have addresses in the routable
            public addressing space.</t>

            <t>IANA is responsible for global coordination of the IP
            addressing system. Aside its address allocation activities,
            it maintains reserved address ranges for special uses.
            These ranges can be categorized into three types:
            Special purpose IPv4 addresses, Special purpose IPv6
            addresses and Multicast reserved addresses.
            </t>

            <t>A name server MUST NOT be using any IP address out of
            any of these reserved special purpose addresses listed in
            the following tables.</t>

        <texttable anchor="ipv4_reserved" title="IPv4 Special purpose adresses">
            <ttcol>Address Block</ttcol>
            <ttcol>Name</ttcol>
            <ttcol>Reference</ttcol>
            <c>0.0.0.0/8</c><c>"This host on this network"</c><c>RFC 1122</c>
            <c>10.0.0.0/8, 192.168.0.0/16, 172.16.0.0/12</c><c>Private-Use</c><c>RFC 1918</c>
            <c>100.64.0.0/10</c><c>Shared Address Space</c><c>RFC 6598</c>
            <c>127.0.0.0/8</c><c>Loopback</c><c>RFC 1122</c>
            <c>169.254.0.0/16</c><c>Link Local</c><c>RFC 3927</c>
            <c>192.0.0.0/24</c><c>IETF Protocol Assignments</c><c>RFC 6890</c>
            <c>192.0.0.0/29</c><c>DS-Lite</c><c>RFC 6333</c>
            <c>192.0.0.170/32, 192.0.0.171/32</c><c>NAT64/DNS64 Discovery</c><c>RFC 7050</c>
            <c>192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24</c><c>Documentation</c><c>RFC 5737</c>
            <c>192.88.99.0/24</c><c>6to4 Relay Anycast</c><c>RFC 3068</c>
            <c>198.18.0.0/15</c><c>Benchmarking</c><c>RFC 2544</c>
            <c>240.0.0.0/4</c><c>Reserved</c><c>RFC 1112</c>
            <c>255.255.255.255/32</c><c>Limited Broadcast</c><c>RFC 919</c>
        </texttable>

        <texttable anchor="ipv6_reserved" title="IPv6 Special purpose adresses">
            <ttcol>Address Block</ttcol>
            <ttcol>Name</ttcol>
            <ttcol>Reference</ttcol>
            <c>::1/128</c><c>Loopback Address</c><c>RFC 4291</c>
            <c>::/128</c><c>Unspecified Address</c><c>RFC 4291</c>
            <c>::ffff:0:0/96</c><c>IPv4-mapped Address</c><c>RFC 4291</c>
            <c>64:ff9b::/96</c><c>IPv4-IPv6 Translation</c><c>RFC 6052</c>
            <c>100::/64</c><c>Discard-Only Address Block</c><c>RFC 6666</c>
            <c>2001::/23</c><c>IETF Protocol Assignments</c><c>RFC 2928</c>
            <c>2001::/32</c><c>TEREDO</c><c>RFC 4380</c>
            <c>2001:2::/48</c><c>Benchmarking</c><c>RFC 5180</c>
            <c>2001:db8::/32</c><c>Documentation</c><c>RFC 3849</c>
            <c>2001:10::/28</c><c>Deprecated (ORCHID)</c><c>RFC 4843</c>
            <c>2002::/16</c><c>6to4</c><c>RFC 3056</c>
            <c>fc00::/7</c><c>Unique-Local</c><c>RFC 4193</c>
            <c>fe80::/10</c><c>Linked-Scoped Unicast</c><c>RFC 4291</c>
            <c>::/96</c><c>Deprecated (IPv4-compatible Address)</c><c>RFC 4291</c>
            <c>5f00::/8, 3ffe::/16</c><c>unallocated (ex 6bone)</c><c>RFC 3701</c>
            <c>2001::/32</c><c>TEREDO</c><c>RFC 4380</c>
            <c>::/0</c><c>Default route</c><c>RFC 5156</c>
        </texttable>

        <texttable anchor="multicast_addresses" title="Multicast addresses">
            <ttcol>Address Block</ttcol>
            <ttcol>Name</ttcol>
            <ttcol>Reference</ttcol>
            <c>224.0.0.0/4</c><c>IPv4 multicast addresses</c><c>RFC 5771</c>
            <c>ff00::/8</c><c>IPv6 multicast addresses</c><c>RFC 4291</c>
        </texttable>


    	</section>
    	<section title="IPv6 address of name server must not to be part of bogon prefix">
    	</section>
    </section>

    <section title="Connectivity requirements">
    	<t>Some text about connectivity.</t>
    	<section title="All name servers to have UDP connectivity over port 53">
    	</section>
    	<section title="All name servers to have TCP connectivity over port 53">
    	</section>
    	<section title="The name servers to not be on the same AS">
    	</section>
    </section>

    <section title="Consistency requirements">
		<t>Some text about consistency.</t>
		<section title="All name servers must respond with the same SOA serial number">
		</section>
		<section title="All name servers must respond with the same SOA RNAME">
		</section>
		<section title="All name servers must respond with the same SOA parameters">
		</section>
		<section title="All name servers must respond with the same NS RR Set">
		</section>
	</section>

    <section title="Delegation requirements">
		<t>Some text about delegations.</t>
		<section title="The delegation must contain at least two name servers">
		</section>
		<section title="The name servers must have distinct IP addresses">
		</section>
		<section title="The referral must fit into an non-truncated 512 byte UPD packet">
		</section>
		<section title="All name servers must be authoritative for the domain">
		</section>
		<section title="The delegation name must exactly match the apex of the child zone">
		</section>
		<section title="Glue records in delegation to exactly match records in child zone">
		</section>
	</section>

    <section title="DNSSEC requirements">
		<t>Some text about DNSSEC.</t>
		<section title="The DS hash digest algorithm must be one of the ones assigned by IANA">
		</section>
		<section title="The DNSKEY algorithm must be one of the ones assigned by IANA">
		</section>
		<section title="DS must match a DNSKEY in the child zone">
		</section>
		<section title="The number of NSEC3 iterations must to be higher than what is allowed">
		</section>
		<section title="RRSIG lifetimes neither must not be too short nor too long">
		</section>
		<section title="The name server must include RRSIG in all responses to DNSSEC queries">
		</section>
		<section title="If child zone includes DNSKEY then parent zone should have DS">
		</section>
		<section title="RRSIG of DNSKEY must be valid and must be created by a valid DNSKEY">
		</section>
		<section title="RRSIG of SOA must be valid and must be created by a valid DNSKEY">
		</section>
		<section title="The name servers must include valid NSEC/NSEC3 record in NXDOMAIN responses">
		</section>
		<section title="Delegation from parent to child must be properly signed">
		</section>
	</section>

    <section title="Syntax requirements">
		<t>Some text about Syntax.</t>
		<section title="No illegal characters must be in the domain name">
		</section>
		<section title="No hyphen must be at start or end of the domain name">
		</section>
		<section title="No hyphens must be in position 3 *and* 4 of the domain name">
		</section>
		<section title="The NS name must be a valid hostname">
		</section>
		<section title="The SOA RNAME must not containt the '@' character">
		</section>
		<section title="The SOA RNAME must have no illegal characters">
		</section>
		<section title="The SOA MNAME to have no illegal characters">
		</section>
		<section title="ThMX record in apex to point at a valid hostname">
		</section>
	</section>

    <section title="Zone requirements">
		<t>Some text about Zone.</t>
		<section title="SOA MNAME must be FQDN of authoritative name server">
		</section>
		<section title="SOA MNAME must be an NS of the zone">
		</section>
		<section title="SOA REFRESH should to be too low">
		</section>
		<section title="SOA RETRY must be lower than 'refresh'">
		</section>
		<section title="SOA RETRY should to be too low">
		</section>
		<section title="SOA EXPIRE should to be too low">
		</section>
		<section title="SOA 'expire' should to be lower than 'refresh'">
		</section>
		<section title="SOA 'minimum' should to be too high">
		</section>
		<section title="SOA 'minimum' should to be too low">
		</section>
		<section title="SOA MNAME must not to point at a CNAME or DNAME alias">
		</section>
		<section title="MX record must not to point at a CNAME or DNAME alias">
		</section>
		<section title="MX record should be present in apex">
		</section>
		<section title="MX record in apex must point at an A or AAAA record">
		</section>
	</section>

  </middle>

  <back>
    <references title="Normative References">
  	  <?rfc include="reference.RFC.1034" ?>
  	  <?rfc include="reference.RFC.1123" ?>
  	  <?rfc include="reference.RFC.2119" ?>
  	  <?rfc include="reference.RFC.2182" ?>
      <?rfc include="reference.I-D.ietf-dnsop-dns-terminology" ?>
    </references>
    <references title="Informative References">
	    <?rfc include="reference.RFC.5730" ?>
    </references>
  </back>

<!-- Change Log
v00 2015-09-18  PW    Initial version
-->

</rfc>
